$(document).ready(function(){function L(){var e=_();O(e)}function A(){var e=M();O(e)}function O(e){var t=S.eq(e);a.get(0).canPlayType("audio/ogg")?a.attr("src",t.attr("data-oggsrc")):a.attr("src",t.attr("data-mp3src")),t.parent().addClass("loading").siblings().removeClass("loading").removeClass("playing"),p.removeClass("play").addClass("pause")}function M(){var e=T.find(".hot ul").children().length,t=parseInt(localStorage.getItem("playingIndex"),10);return t+=1,t===e&&(t=0),localStorage.setItem("playingIndex",t),t}function _(){var e=T.find(".hot ul").children().length,t=parseInt(localStorage.getItem("playingIndex"),10);return t-=1,t===-1&&(t=e-1),localStorage.setItem("playingIndex",t),t}var e=$("#preload"),t=e.find("#when"),n=e.find("#who"),r=$("#background"),i=$("#background img"),s=$("#sidebar"),o=$("#sidebar .controls"),u=$("#sidebar .controls .button"),a=$("#mediaplayer"),f=$("#review"),l=f.find(".back a"),c=$("#notice"),a=$("#mediaplayer"),h=$("#player"),p=h.find("#mainControl"),d=h.find("#changeSong"),v=d.find(".prev"),m=d.find(".next"),g=h.find(".loop"),y=h.find(".shuffle"),b=$(".volume"),w=b.find(".volumebar"),E=$("#profile .hot li"),S=$("#profile .hot a"),x=$("button.special"),T=$("#profile");e.delay(8e3).animate({height:0},1e3),t.delay(1e3).fadeIn(800).delay(6200).fadeOut(1e3),n.delay(3500).fadeIn(800).delay(3700).fadeOut(1e3),T.draggable(),p.hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","default")}),p.click(function(){if($(this).hasClass("pause")){if($("#profile .hot li.loading").length>0)return;$(this).removeClass("pause").addClass("play"),a.get(0).play()}else $(this).removeClass("play").addClass("pause"),a.get(0).pause()}),p.hover(function(){d.stop().fadeIn(1e3),$(this).addClass("hover")},function(){d.stop().fadeOut(600),$(this).removeClass("hover")}),v.hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),m.hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),v.click(function(e){e.stopPropagation(),L()}),m.click(function(e){e.stopPropagation(),A()});var N=$("#profile .hot ul").children().length,C;localStorage.getItem("playingIndex")||localStorage.setItem("playingIndex",0),C=parseInt(localStorage.getItem("playingIndex"),10),$("#profile .hot li").eq(C).addClass("loading"),a.get(0).canPlayType("audio/ogg")?a.attr("src",S.eq(C).attr("data-oggsrc")):a.attr("src",S.eq(C).attr("data-mp3src")),g.hover(function(){g.addClass("hover")},function(){g.removeClass("hover")}),g.click(function(){$(this).hasClass("on")?($(this).removeClass("on"),localStorage.setItem("loop",0),a.removeAttr("loop")):(y.hasClass("on")&&(y.removeClass("on"),localStorage.setItem("shuffle",0)),$(this).addClass("on"),localStorage.setItem("loop",1),a.attr("loop","loop"))}),b.hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","default")}),w.hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),w.click(function(){a.get(0).volume=(w.index(this)+1)/b.children().length,window.localStorage.setItem("volume",w.index(this)+1),$(this).addClass("on").prevAll().addClass("on"),$(this).nextAll().removeClass("on")}),window.localStorage.getItem("volume")||(window.localStorage.setItem("volume",Math.ceil(b.children().length/2)),a.get(0).volume=Math.ceil(b.children().length/2)/b.children().length);var k=parseInt(window.localStorage.getItem("volume"),10);w.eq(k-1).addClass("on").prevAll().addClass("on"),w.eq(k-1).nextAll().removeClass("on"),S.click(function(e){e.preventDefault();if(navigator.userAgent.indexOf("MSIE")>-1)return;if($(this).parent().hasClass("loading")||$(this).parent().hasClass("playing"))return;a.get(0).canPlayType("audio/ogg")?a.attr("src",$(this).attr("data-oggsrc")):a.attr("src",$(this).attr("data-mp3src")),localStorage.setItem("playingIndex",S.index($(this))),$(this).parent().addClass("loading").siblings().removeClass("loading").removeClass("playing"),p.removeClass("play").addClass("pause")}),S.mouseover(function(e){navigator.userAgent.indexOf("MSIE")>-1&&$(this).css("cursor","default")}),$("<img />").attr("src",i.attr("src")).load(function(){var e=this.width,t=this.height,n=e/t,s=$(window).width(),o=$(window).height(),u=s/o,a;n>=u?(i.css("height",o),a=Math.floor((o*n-s)/2),r.css("left",-a)):(i.css("width",s),r.css("left",0)),$(window).on("resize",function(){clearTimeout(this.id),this.id=setTimeout(function(){s=$(window).width(),o=$(window).height(),u=s/o,n>=u?(i.css("height",o),i.css("width","auto"),a=Math.floor((o*n-s)/2),r.css("left",-a)):(i.css("width",s),i.css("height","auto"),r.css("left",0))},50)})}),a.get(0).addEventListener("ended",function(e){A()}),a.get(0).addEventListener("canplay",function(e){$("#profile .hot .loading").addClass("playing").removeClass("loading"),p.removeClass("pause").addClass("play")})});