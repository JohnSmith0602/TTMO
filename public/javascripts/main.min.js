$(document).ready(function(){var m=$("#preload"),p=m.find("#when"),j=m.find("#who"),k=$("#background"),i=$("#background img"),n=$("#sidebar"),f=$("#sidebar .controls"),g=$("#sidebar .controls .button"),r=$("#mediaplayer"),A=$("#review"),x=A.find(".back a"),b=$("#notice");var r=$("#mediaplayer");var w=$("#player");var q=w.find("#mainControl");var l=w.find("#changeSong");var t=l.find(".prev");var v=l.find(".next");var d=w.find(".loop");var h=w.find(".shuffle");var z=$(".volume");var y=z.find(".volumebar");var o=$("#profile .hot li");var c=$("#profile .hot a");var e=$("button.special");q.hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","default")});q.click(function(){if($(this).hasClass("pause")){if($("#profile .hot li.loading").length>0){return}$(this).removeClass("pause").addClass("play");r.get(0).play()}else{$(this).removeClass("play").addClass("pause");r.get(0).pause()}});var s=$("#profile .hot ul").children().length;var u;if(!localStorage.getItem("playingIndex")){localStorage.setItem("playingIndex",0)}u=parseInt(localStorage.getItem("playingIndex"),10);$("#profile .hot li").eq(u).addClass("loading");if(r.get(0).canPlayType("audio/ogg")){r.attr("src",c.eq(u).attr("data-oggsrc"))}else{r.attr("src",c.eq(u).attr("data-mp3src"))}if(!r.get(0).paused){$("#profile .hot .loading").addClass("playing").removeClass("loading");q.removeClass("pause").addClass("play")}r.get(0).addEventListener("canplay",function(B){$("#profile .hot .loading").addClass("playing").removeClass("loading");q.removeClass("pause").addClass("play")});d.hover(function(){d.addClass("hover")},function(){d.removeClass("hover")});d.click(function(){if($(this).hasClass("on")){$(this).removeClass("on");localStorage.setItem("loop",0);r.removeAttr("loop")}else{if(h.hasClass("on")){h.removeClass("on");localStorage.setItem("shuffle",0)}$(this).addClass("on");localStorage.setItem("loop",1);r.attr("loop","loop")}});z.hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","default")});y.hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});y.click(function(){r.get(0).volume=(y.index(this)+1)/z.children().length;window.localStorage.setItem("volume",y.index(this)+1);$(this).addClass("on").prevAll().addClass("on");$(this).nextAll().removeClass("on")});if(!window.localStorage.getItem("volume")){window.localStorage.setItem("volume",Math.ceil(z.children().length/2));r.get(0).volume=Math.ceil(z.children().length/2)/z.children().length}var a=parseInt(window.localStorage.getItem("volume"),10);y.eq(a-1).addClass("on").prevAll().addClass("on");y.eq(a-1).nextAll().removeClass("on");c.click(function(B){B.preventDefault();if(navigator.userAgent.indexOf("MSIE")>-1){return}else{if($(this).parent().hasClass("loading")||$(this).parent().hasClass("playing")){return}else{if(r.get(0).canPlayType("audio/ogg")){r.attr("src",$(this).attr("data-oggsrc"))}else{r.attr("src",$(this).attr("data-mp3src"))}localStorage.setItem("playingIndex",c.index($(this)));$(this).parent().addClass("loading").siblings().removeClass("loading").removeClass("playing");q.removeClass("play").addClass("pause")}}});c.mouseover(function(B){if(navigator.userAgent.indexOf("MSIE")>-1){$(this).css("cursor","default")}});$("<img />").attr("src",i.attr("src")).load(function(){var D=this.width;var B=this.height;var C=D/B;var F=$(window).width();var H=$(window).height();var E=F/H;var G;if(C>=E){i.css("height",H);G=Math.floor((H*C-F)/2);k.css("left",-G)}else{i.css("width",F);k.css("left",0)}$(window).on("resize",function(){clearTimeout(this.id);this.id=setTimeout(function(){F=$(window).width();H=$(window).height();E=F/H;if(C>=E){i.css("height",H);i.css("width","auto");G=Math.floor((H*C-F)/2);k.css("left",-G)}else{i.css("width",F);i.css("height","auto");k.css("left",0)}},50)})});m.delay(8000).animate({height:0},1000);p.delay(1000).fadeIn(800).delay(6200).fadeOut(1000);j.delay(3500).fadeIn(800).delay(3700).fadeOut(1000);r.get(0).addEventListener("ended",function(C){var D=$("#profile .hot ul").children().length;var B=parseInt(localStorage.getItem("playingIndex"),10);B+=1;if(B===D){B=0}localStorage.setItem("playingIndex",B);var E=c.eq(B);if(r.get(0).canPlayType("audio/ogg")){r.attr("src",E.attr("data-oggsrc"))}else{r.attr("src",E.attr("data-mp3src"))}E.parent().addClass("loading").siblings().removeClass("loading").removeClass("playing");q.removeClass("play").addClass("pause")});e.click(function(){r.get(0).pause();q.removeClass("pause").addClass("play");window.open("/specials/demo/music-card","_blank")})});